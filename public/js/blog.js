// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    var NUMBER_OF_BG_IMAGES, app,
      _this = this;
    NUMBER_OF_BG_IMAGES = 11;
    app = window || {};
    app.BlogModel = Backbone.Model.extend({
      urlRoot: '/posts',
      defaults: function() {
        return {
          slug: "default-title",
          date: "1-1-13",
          title: "Default Title",
          body: "hello world!"
        };
      }
    });
    app.BlogPosts = Backbone.Collection.extend({
      model: app.BlogModel,
      url: '/posts',
      getPostBySlug: function(slug) {
        return this.findWhere({
          slug: slug
        });
      }
    });
    return app.BlogPostView = Backbone.View.extend({
      tagName: 'div',
      className: 'blogPost',
      template: _.template($('#blogView-template').html()),
      initialize: function() {
        _.bindAll(this);
        this.isFlipped = false;
        this.comments = new app.Comments({
          url: '/comments/' + this.model.get('slug')
        });
        return this.comments.fetch();
      },
      render: function(eventName) {
        $(this.el).html(this.template(this.model.toJSON()));
        return this;
      },
      unrender: function() {
        return $(_this.el).remove();
      },
      hide: function() {
        return $(this.el).hide(500);
      },
      flip: function() {
        var back, back_content, commentsView, front;
        console.log("FLIP MUTHERFUCKER");
        front = this.el;
        commentsView = new app.CommentsView({
          collection: this.comments,
          model: this.model
        });
        back_content = commentsView.render().el;
        back = flippant.flip(front, back_content.innerHTML);
        return back.addEventListener('dblclick', function(e) {
          return back = back.close();
        });
      },
      gotoSlug: function() {
        return app.router.navigate("post/" + (this.model.get('slug')), {
          trigger: true
        });
      },
      events: {
        'click .close': 'hide',
        'click .title': 'gotoSlug',
        'dblclick': 'flip'
      }
    });
  });

}).call(this);
